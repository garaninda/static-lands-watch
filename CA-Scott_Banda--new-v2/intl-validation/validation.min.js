// @ts-nocheck
import"https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/intlTelInput.min.js";import JustValidate from"https://cdn.jsdelivr.net/npm/just-validate@4/dist/just-validate.es.min.js";const FIELD_NAME="first_name",FIELD_SURNAME="last_name",FIELD_PHONE="phone",FIELD_EMAIL="email",FULL_PHONE_FIELD_NAME="phone_full",COUNTRY_FIELD_NAME="country",COUNTRY_CODE_FIELD="area_code",dictionary=[{key:"Name cannot contain numbers",dict:{es:"El nombre no puede contener números",fr:"Le nom ne peut pas contenir des chiffres",ru:"Имя не может содержать цифры",bg:"Името не може да съдържа цифри",it:"Il nome non può contenere cifre",rs:"Ime ne može sadržati brojeve"}},{key:"Name is required",dict:{es:"Se requiere el nombre",fr:"Le nom est requis",ru:"Укажите имя",bg:"Дайте ми име",it:"Dammi un nome",rs:"Unesite svoje ime"}},{key:"Name is too short",dict:{es:"El nombre es muy corto",fr:"Le nom est trop court",ru:"Имя слишком короткое",bg:"Името е твърде кратко",it:"Il nome è troppo corto",rs:"Unesite svoje puno ime"}},{key:"Name is too long",dict:{es:"El nombre es demasiado largo",fr:"Le nom est trop long",ru:"Имя слишком длинное",bg:"Името е твърде дълго",it:"Il nome è troppo lungo",rs:"Ime je predugačko"}},{key:"Surname cannot contain numbers",dict:{es:"El apellido no puede contener números",fr:"Le nom de famille ne peut pas contenir des chiffres",ru:"Фамилия не может содержать цифры",bg:"Фамилията не може да съдържа цифри",it:"Il cognome non può contenere cifre",rs:"Prezime ne može sadržati brojeve"}},{key:"Surname is required",dict:{es:"Se requiere el apellido",fr:"Le nom de famille est requis",ru:"Укажите фамилию",bg:"Дайте ми фамилия",it:"Dammi un cognome",rs:"Unesite svoje prezime"}},{key:"Surname is too short",dict:{es:"El apellido es muy corto",fr:"Le nom de famille est trop court",ru:"Фамилия слишком короткая",bg:"Фамилията е твърде кратка",it:"Il cognome è troppo corto",rs:"Prezime je prekratko"}},{key:"Surname is too long",dict:{es:"El apellido es demasiado largo",fr:"Le nom de famille est trop long",ru:"Фамилия слишком длинная",bg:"Фамилията е твърде дълга",it:"Il cognome è troppo lungo",rs:"Prezime je predugačko"}},{key:"Phone is required",dict:{es:"Teléfono requerido",fr:"Téléphone requis",ru:"Телефон обязателен",bg:"Телефонът е задължителен",it:"Telefono richiesto",rs:"Unesite svoj broj telefona"}},{key:"Phone is invalid",dict:{es:"Número de teléfono incorrecto",fr:"Mauvais numéro de téléphone",ru:"Неверный номер телефона",bg:"Грешен телефонен номер",it:"Numero di telefono sbagliato",rs:"Pogrešan broj telefona"}},{key:"Email is required",dict:{es:"Correo electrónico requerido",fr:"E-mail requis",ru:"E-mail обязателен",bg:"Имейлът е задължителен",it:"Email richiesta",rs:"Unesite svoj email"}},{key:"Email is invalid",dict:{es:"Correo electrónico inválido",fr:"E-mail invalide",ru:"Некорректный e-mail",bg:"Невалиден имейл",it:"Email non valida",rs:"Neispravan email"}}],lang="en";function trackConversion(){"undefined"!=typeof fbq&&fbq.loaded&&(fbq("track","Lead"),console.log("Lead"))}function getCookie(e){const o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return o?decodeURIComponent(o[2]):null}function setCookie(e,o,r){const t=r?new Date(Date.now()+1e3*r).toUTCString():"",n=`${encodeURIComponent(e)}=${encodeURIComponent(o)}`,i=t?`; expires=${t}`:"";document.cookie=[n,"path=/",i].join("; ")}function showDuplicatePopup(){$("body").append('\n<div id="overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0, 0, 0, 0.5); z-index:999;"></div>\n');$("body").append('\n<div id="duplicate-email-popup" style="position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:1000; background:#fff; box-shadow:0 0 15px rgba(0,0,0,0.3); padding:25px; border-radius:10px; text-align:center; font-family: Arial, Helvetica, sans-serif; max-width:350px; width:100%; color:#333;">\n<p style="font-size:16px; margin-bottom:20px;">You have already left a request, please wait for the operator to call you.</p>\n<button onclick="closePopup()" style="background-color:#7ed321; color:#fff; border:none; padding:10px 20px; font-size:16px; cursor:pointer; border-radius:5px; transition: background-color 0.3s ease;">\n  OK\n</button>\n</div>\n')}function showMessagePopup(e){$("body").append('\n<div id="overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0, 0, 0, 0.5); z-index:999;"></div>\n');const o=`\n<div id="duplicate-email-popup" style="position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:1000; background:#fff; box-shadow:0 0 15px rgba(0,0,0,0.3); padding:25px; border-radius:10px; text-align:center; font-family: Arial, Helvetica, sans-serif; max-width:350px; width:100%; color:#333;">\n<p style="font-size:16px; margin-bottom:20px;">${e}</p>\n<button onclick="closePopup()" style="background-color:#7ed321; color:#fff; border:none; padding:10px 20px; font-size:16px; cursor:pointer; border-radius:5px; transition: background-color 0.3s ease;">\n  OK\n</button>\n</div>\n`;$("body").append(o)}function disableSubmit(e){$(e).find('button[type="submit"]').attr("disabled",!0)}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll('form[method="post"]').forEach((e=>{const o=e.querySelector('input[name="phone"]'),r=intlTelInput(o,{loadUtils:()=>import("https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/utils.js"),allowDropdown:!1,initialCountry:"CA",strictMode:!0,countrySearch:!1,autoPlaceholder:"aggressive",onlyCountries:["CA"],separateDialCode:!0,hiddenInput:e=>({phone:"phone_full",country:"country",code:"area_code"})}),t=new JustValidate(e,{validateBeforeSubmitting:!0,tooltip:{position:"top"}},dictionary);t.setCurrentLocale("en"),o.addEventListener("change",(()=>{console.log(r.getNumber())})),e.querySelector('input[name="email"]')&&t.addField(e.querySelector('input[name="email"]'),[{rule:"required",errorMessage:"Email is required"},{rule:"email",errorMessage:"Email is invalid"}]),e.querySelector(`input[name="${FIELD_NAME}"]`)&&t.addField(e.querySelector(`input[name="${FIELD_NAME}"]`),[{rule:"customRegexp",value:/^[^0-9]+$/g,errorMessage:"Name cannot contain numbers"},{rule:"required",errorMessage:"Name is required"},{rule:"minLength",value:3,errorMessage:"Name is too short"}]),e.querySelector('input[name="last_name"]')&&t.addField(e.querySelector('input[name="last_name"]'),[{rule:"customRegexp",value:/^[^0-9]+$/g,errorMessage:"Surname cannot contain numbers"},{rule:"required",errorMessage:"Surname is required"}]),e.querySelector('input[name="phone"]')&&t.addField(e.querySelector('input[name="phone"]'),[{rule:"required",errorMessage:"Phone is required"},{validator:function(e){return Boolean(r.isValidNumber())},errorMessage:"Phone is invalid"}]),t.onSuccess((o=>{o.preventDefault();const t=new FormData(e);document.querySelector(".rf-form__loader").style.display="",t.set("phone_full",r.getNumber()),t.set("country",r.getSelectedCountryData().iso2),t.set("area_code",`+${r.getSelectedCountryData().dialCode}`),fetch(e.action,{method:e.method,body:t,credentials:"same-origin"}).then((async o=>{let r;document.querySelector(".rf-form__loader").style.display="none";try{r=await o.json()}catch(e){throw showMessagePopup("Unexpected server response."),e}if(o.ok&&r.lead_uuid&&r.auto_login_url){e.querySelector('[type="submit"]').disabled=!0;const o=e.querySelector('input[name="email"]');o&&setCookie("user_email_recent",o.value,3600),trackConversion();const t=r.auto_login_url,n=setTimeout((()=>{window.location.href=t,clearTimeout(n)}),5e3);showMessagePopup(`Registration completed successfully.<br>Registration ID: ${r.lead_uuid}<br>You will now be redirected.`)}else{if(r&&r.code)switch(r.code){case 400:case 422:"DUPLICATION_ERROR"===r.type||r.data&&"DUPLICATION_ERROR"===r.data.errorType?showDuplicatePopup():r.data&&r.data.errorMessage?showMessagePopup(r.data.errorMessage):r.message?showMessagePopup(r.message):showMessagePopup("Validation error.");break;case 401:showMessagePopup("Authorization error. Please contact support.");break;case 404:showMessagePopup("API route not found. Please contact support.");break;case 410:showMessagePopup("API version is not supported. Please contact support.");break;case 415:showMessagePopup("Unsupported content type. Please contact support.");break;case 429:showMessagePopup("Rate limit exceeded. Please try again later.");break;default:showMessagePopup(r.message||"An unexpected error has occurred.")}else showMessagePopup("An unexpected error has occurred.");e.querySelector('[type="submit"]').disabled=!1}})).catch((o=>{console.error("Error:",o),e.querySelector('[type="submit"]').disabled=!1,document.querySelector(".rf-form__loader").style.display="none",showMessagePopup("An unexpected error has occurred.")}))}))}))}));